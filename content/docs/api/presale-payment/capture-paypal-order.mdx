---
title: Capture PayPal Order For Presale
description: Confirm and capture PayPal payments after user authorization
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Card, Cards } from 'fumadocs-ui/components/card';

<div className="relative overflow-hidden rounded-2xl bg-gradient-to-br from-rose-500 via-pink-600 to-fuchsia-700 p-8 mb-8">
  <div className="relative z-10">
    <h1 className="text-4xl md:text-5xl font-bold mb-4 text-white">
      Capture PayPal Order
    </h1>
    <p className="text-xl text-white/90 mb-6">
      Finalize PayPal payments and update presale order status
    </p>
  </div>
  <div className="absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl"></div>
  <div className="absolute bottom-0 left-0 w-96 h-96 bg-white/5 rounded-full blur-3xl"></div>
</div>

## Mutation

<div className="rounded-xl border border-rose-500/30 bg-gradient-to-br from-rose-500/10 to-rose-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">‚úÖ</span>
    <div>
      <div className="font-bold text-lg">captureOrderForPresale</div>
      <div className="text-sm text-muted-foreground">Confirm PayPal payment and update order</div>
    </div>
  </div>

  ### Schema

  ```graphql
  captureOrderForPresale(
    orderId: String!
  ): Boolean
  ```
</div>

## Parameters

<div className="space-y-4 my-6">
  <div className="p-5 rounded-lg border border-border bg-muted/30">
    <div className="flex items-center gap-2 mb-2">
      <code className="bg-rose-500/20 text-rose-500 px-2 py-0.5 rounded font-mono text-sm">orderId</code>
      <span className="text-xs bg-red-500/20 text-red-500 px-2 py-0.5 rounded font-semibold">Required</span>
    </div>
    <div className="text-sm">
      <div className="font-semibold mb-1">Type: <code className="bg-muted px-1 rounded">String!</code></div>
      <div className="text-muted-foreground">The PayPal order ID to capture (returned from paypalForPresale)</div>
    </div>
  </div>
</div>

## Return Value

<div className="p-5 rounded-lg border border-green-500/30 bg-green-500/10 my-6">
  <div className="flex items-center gap-2 mb-2">
    <span className="text-lg">üì¶</span>
    <div className="font-bold">Returns Boolean</div>
  </div>
  <div className="text-sm text-muted-foreground">
    Returns <code className="bg-muted px-1 rounded">true</code> if capture successful, <code className="bg-muted px-1 rounded">false</code> otherwise
  </div>
</div>

## Example

<div className="rounded-xl border border-purple-500/30 bg-gradient-to-br from-purple-500/10 to-purple-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">üíª</span>
    <div>
      <div className="font-bold">Usage Example</div>
      <div className="text-xs text-muted-foreground">Capture PayPal order after user approval</div>
    </div>
  </div>

  ```graphql
  mutation {
    captureOrderForPresale(
      orderId: "5O190127TN364715T"
    )
  }
  ```
</div>

## Response Example

<div className="rounded-xl border border-green-500/30 bg-gradient-to-br from-green-500/10 to-green-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">üì§</span>
    <div>
      <div className="font-bold">Sample Response</div>
      <div className="text-xs text-muted-foreground">Successful capture</div>
    </div>
  </div>

  ```json
  {
    "data": {
      "captureOrderForPresale": true
    }
  }
  ```
</div>

## How It Works

<div className="rounded-xl border border-cyan-500/30 bg-gradient-to-br from-cyan-500/10 to-cyan-500/5 p-6 my-8">
  <div className="flex items-center gap-3 mb-6">
    <span className="text-2xl">üîÑ</span>
    <div>
      <div className="font-bold text-lg">Capture Process</div>
      <div className="text-sm text-muted-foreground">Backend verification and order update</div>
    </div>
  </div>

  <div className="space-y-3">
    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center gap-2 mb-2">
        <span className="text-cyan-500 font-bold text-lg">1</span>
        <div className="font-semibold text-sm">Verify Order ID</div>
      </div>
      <div className="text-xs text-muted-foreground">
        Backend validates the PayPal order ID with PayPal's API
      </div>
    </div>

    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center gap-2 mb-2">
        <span className="text-cyan-500 font-bold text-lg">2</span>
        <div className="font-semibold text-sm">Check Payment Status</div>
      </div>
      <div className="text-xs text-muted-foreground">
        Confirms that the payment was approved and completed by the user
      </div>
    </div>

    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center gap-2 mb-2">
        <span className="text-cyan-500 font-bold text-lg">3</span>
        <div className="font-semibold text-sm">Capture Funds</div>
      </div>
      <div className="text-xs text-muted-foreground">
        Backend captures the authorized funds from PayPal
      </div>
    </div>

    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center gap-2 mb-2">
        <span className="text-cyan-500 font-bold text-lg">4</span>
        <div className="font-semibold text-sm">Update Presale Order</div>
      </div>
      <div className="text-xs text-muted-foreground">
        Updates the presale order status and triggers token delivery
      </div>
    </div>
  </div>
</div>

## Important Notes

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
  <div className="p-5 rounded-lg border border-amber-500/30 bg-amber-500/10">
    <div className="text-xl mb-2">‚ö†Ô∏è</div>
    <div className="font-bold mb-2">Call After Redirect</div>
    <div className="text-sm text-muted-foreground">
      Only call this mutation after the user returns from PayPal checkout
    </div>
  </div>

  <div className="p-5 rounded-lg border border-blue-500/30 bg-blue-500/10">
    <div className="text-xl mb-2">üîê</div>
    <div className="font-bold mb-2">Backend Verification</div>
    <div className="text-sm text-muted-foreground">
      The backend verifies payment with PayPal before updating the order
    </div>
  </div>

  <div className="p-5 rounded-lg border border-green-500/30 bg-green-500/10">
    <div className="text-xl mb-2">‚úÖ</div>
    <div className="font-bold mb-2">Idempotent Operation</div>
    <div className="text-sm text-muted-foreground">
      Safe to call multiple times - subsequent calls will return the same result
    </div>
  </div>

  <div className="p-5 rounded-lg border border-purple-500/30 bg-purple-500/10">
    <div className="text-xl mb-2">üí°</div>
    <div className="font-bold mb-2">Error Handling</div>
    <div className="text-sm text-muted-foreground">
      Returns false if payment wasn't completed or if the order ID is invalid
    </div>
  </div>
</div>

<div className="mt-8 p-6 rounded-xl border border-rose-500/30 bg-gradient-to-r from-rose-500/10 to-pink-500/10">
  <div className="flex items-center gap-3">
    <span className="text-2xl">üí°</span>
    <div>
      <div className="font-bold">Best Practice</div>
      <div className="text-sm text-muted-foreground">
        Extract the order ID from the return URL query parameters when PayPal redirects users back to your site. Call this mutation immediately to capture the payment. Display appropriate success or error messages to users based on the response. Consider implementing webhook handlers for more reliable payment confirmation.
      </div>
    </div>
  </div>
</div>
