---
title: Approve Fiat Withdrawal Request
description: Admin approval of bank withdrawal after manual fund transfer
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Card, Cards } from 'fumadocs-ui/components/card';

<div className="relative overflow-hidden rounded-2xl bg-gradient-to-br from-red-500/10 via-rose-500/5 to-background p-8 border border-red-500/20 mb-8">
  <div className="relative z-10">
    <h1 className="text-3xl md:text-4xl font-bold mb-4">
      Approve Fiat Withdrawal Request
    </h1>
    <p className="text-lg text-muted-foreground mb-4">
      Confirm manual bank transfer completion with 2FA verification
    </p>
    <div className="inline-block px-3 py-1 rounded-full bg-red-500/20 border border-red-500/30 text-red-400 text-sm font-medium">
      ADMIN Only
    </div>
  </div>
  <div className="absolute top-0 right-0 w-48 h-48 bg-red-500/5 rounded-full blur-3xl"></div>
</div>

## Overview

The `approveBankWithdrawRequest` mutation allows administrators to approve bank withdrawal requests after manually transferring funds. Since bank transfers cannot be automated, admins must physically send the funds and then call this mutation to update the request status.

<Callout type="warn" title="Manual Transfer Required">
The admin must **manually transfer funds** to the specified bank account **before** calling this mutation to mark the request as approved.
</Callout>

## GraphQL Schema

<div className="rounded-xl border border-rose-500/30 bg-gradient-to-br from-rose-500/10 to-rose-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">üè¶</span>
    <div>
      <div className="font-bold text-lg">Mutation Schema</div>
      <div className="text-sm text-muted-foreground">Approve bank withdrawal after manual transfer</div>
    </div>
  </div>

  ```graphql
  approveBankWithdrawRequest(
    id: Int!,
    code: String!
  ): Int
  ```
</div>

## Parameters

<div className="rounded-xl border border-blue-500/30 bg-gradient-to-br from-blue-500/10 to-blue-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">üìã</span>
    <div>
      <div className="font-bold text-lg">Required Parameters</div>
    </div>
  </div>

  <div className="space-y-3">
    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center justify-between mb-2">
        <code className="font-semibold">id</code>
        <span className="px-2 py-1 rounded bg-rose-500/20 border border-rose-500/30 text-rose-400 text-xs font-medium">Int! Required</span>
      </div>
      <div className="text-sm text-muted-foreground">
        The unique ID of the bank withdrawal request to approve
      </div>
    </div>

    <div className="p-4 rounded-lg bg-background border border-border">
      <div className="flex items-center justify-between mb-2">
        <code className="font-semibold">code</code>
        <span className="px-2 py-1 rounded bg-rose-500/20 border border-rose-500/30 text-rose-400 text-xs font-medium">String! Required</span>
      </div>
      <div className="text-sm text-muted-foreground">
        Admin 2FA verification code received via SMS from <code className="bg-muted px-1 rounded">sendWithdrawConfirmCode</code>
      </div>
    </div>
  </div>
</div>

## Return Value

<div className="rounded-xl border border-green-500/30 bg-gradient-to-br from-green-500/10 to-green-500/5 p-6 my-6">
  <div className="flex items-center gap-3 mb-4">
    <span className="text-2xl">üìä</span>
    <div>
      <div className="font-bold text-lg">Integer Response</div>
      <div className="text-sm text-muted-foreground">Updated status value</div>
    </div>
  </div>

  <div className="p-4 rounded-lg bg-background border border-border">
    <div className="font-semibold mb-2">Return Type: <code className="bg-muted px-2 py-1 rounded text-sm">Int</code></div>
    <div className="text-sm text-muted-foreground">
      Returns an integer indicating the updated status of the withdrawal request (typically 1 for approved).
    </div>
  </div>
</div>

## Example Mutation

<div className="my-6">
  <div className="font-bold mb-3 flex items-center gap-2">
    <span>‚úÖ</span>
    <span>Approve Bank Withdrawal After Transfer</span>
  </div>

  ```graphql
  mutation {
    approveBankWithdrawRequest(
      id: 123,
      code: "654321"
    )
  }
  ```

  <div className="mt-4 p-4 rounded-lg border border-border bg-muted/30">
    <div className="font-semibold text-sm mb-2">Example Response</div>
    ```json
    {
      "data": {
        "approveBankWithdrawRequest": 1
      }
    }
    ```
  </div>
</div>

## Implementation Example

<div className="my-6">
  ```typescript
  async function approveBankWithdrawal(requestId: number) {
    try {
      // Step 1: Verify funds have been manually transferred
      const confirmed = await confirmManualTransferComplete(requestId);

      if (!confirmed) {
        throw new Error('Funds must be transferred before approval');
      }

      // Step 2: Request 2FA code
      const codeRequest = await client.request(gql`
        mutation {
          sendWithdrawConfirmCode
        }
      `);

      if (!codeRequest.sendWithdrawConfirmCode) {
        throw new Error('Failed to send 2FA code');
      }

      console.log('‚úÖ 2FA code sent to admin phone');

      // Step 3: Get 2FA code from admin
      const twoFactorCode = await promptAdminFor2FACode();

      // Step 4: Approve the withdrawal
      const result = await client.request(gql`
        mutation ApproveBank($id: Int!, $code: String!) {
          approveBankWithdrawRequest(
            id: $id,
            code: $code
          )
        }
      `, {
        id: requestId,
        code: twoFactorCode
      });

      console.log('‚úÖ Bank withdrawal approved in system');

      // Step 5: Notify user
      await notifyUserOfApproval(requestId);

      return result.approveBankWithdrawRequest;

    } catch (error) {
      console.error('Bank withdrawal approval failed:', error);
      throw error;
    }
  }
  ```
</div>

## Admin Workflow

<div className="rounded-xl border border-purple-500/30 bg-gradient-to-br from-purple-500/10 to-purple-500/5 p-6 my-6">
  <div className="font-bold text-lg mb-4">Complete Bank Withdrawal Process</div>

  <div className="space-y-4">
    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">1</div>
      <div>
        <div className="font-bold text-sm">Review Withdrawal Request</div>
        <div className="text-xs text-muted-foreground mt-1">Verify all banking details, account holder name, and user verification status</div>
      </div>
    </div>

    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">2</div>
      <div>
        <div className="font-bold text-sm">Initiate Bank Transfer</div>
        <div className="text-xs text-muted-foreground mt-1">Manually transfer funds via bank wire, SWIFT, or domestic transfer to user's account</div>
      </div>
    </div>

    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">3</div>
      <div>
        <div className="font-bold text-sm">Confirm Transfer Completion</div>
        <div className="text-xs text-muted-foreground mt-1">Verify bank transfer was successful and funds were sent</div>
      </div>
    </div>

    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">4</div>
      <div>
        <div className="font-bold text-sm">Request 2FA Code</div>
        <div className="text-xs text-muted-foreground mt-1">Call <code className="bg-muted px-1 rounded">sendWithdrawConfirmCode</code> to receive SMS verification</div>
      </div>
    </div>

    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">5</div>
      <div>
        <div className="font-bold text-sm">Approve in System</div>
        <div className="text-xs text-muted-foreground mt-1">Call <code className="bg-muted px-1 rounded">approveBankWithdrawRequest</code> with 2FA code to update status</div>
      </div>
    </div>

    <div className="flex items-start gap-3">
      <div className="w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-bold flex-shrink-0">6</div>
      <div>
        <div className="font-bold text-sm">Record Transfer Details</div>
        <div className="text-xs text-muted-foreground mt-1">Document transaction reference number and transfer date for records</div>
      </div>
    </div>
  </div>
</div>

## Security Features

<div className="rounded-xl border border-red-500/30 bg-gradient-to-br from-red-500/10 to-red-500/5 p-6 my-6">
  <div className="font-bold text-lg mb-4 flex items-center gap-2">
    <span>üîí</span>
    <span>Security Measures</span>
  </div>

  <div className="space-y-3">
    <div className="flex items-start gap-3 p-4 rounded-lg bg-background border border-border">
      <div className="text-xl">üì±</div>
      <div className="flex-1">
        <div className="font-bold text-sm">2FA SMS Required</div>
        <div className="text-xs text-muted-foreground mt-1">
          All approvals require valid 2FA SMS verification code
        </div>
      </div>
    </div>

    <div className="flex items-start gap-3 p-4 rounded-lg bg-background border border-border">
      <div className="text-xl">üë®‚Äçüíº</div>
      <div className="flex-1">
        <div className="font-bold text-sm">Admin-Only Access</div>
        <div className="text-xs text-muted-foreground mt-1">
          Only users with ADMIN role can approve bank withdrawals
        </div>
      </div>
    </div>

    <div className="flex items-start gap-3 p-4 rounded-lg bg-background border border-border">
      <div className="text-xl">‚úÖ</div>
      <div className="flex-1">
        <div className="font-bold text-sm">Transfer Verification</div>
        <div className="text-xs text-muted-foreground mt-1">
          Admin must confirm funds were actually transferred before approval
        </div>
      </div>
    </div>

    <div className="flex items-start gap-3 p-4 rounded-lg bg-background border border-border">
      <div className="text-xl">üìä</div>
      <div className="flex-1">
        <div className="font-bold text-sm">Audit Trail</div>
        <div className="text-xs text-muted-foreground mt-1">
          All approvals logged with timestamp, admin identity, and transfer details
        </div>
      </div>
    </div>
  </div>
</div>

## Best Practices

<div className="space-y-3 my-6">
  <div className="p-4 rounded-lg border border-border bg-muted/30">
    <div className="flex items-start gap-3">
      <span className="text-lg">‚úÖ</span>
      <div>
        <div className="font-bold text-sm">Verify Transfer Before Approval</div>
        <div className="text-xs text-muted-foreground mt-1">
          Always confirm funds were successfully sent before calling this mutation
        </div>
      </div>
    </div>
  </div>

  <div className="p-4 rounded-lg border border-border bg-muted/30">
    <div className="flex items-start gap-3">
      <span className="text-lg">‚úÖ</span>
      <div>
        <div className="font-bold text-sm">Document Transfer Reference</div>
        <div className="text-xs text-muted-foreground mt-1">
          Record bank transaction reference number for dispute resolution
        </div>
      </div>
    </div>
  </div>

  <div className="p-4 rounded-lg border border-border bg-muted/30">
    <div className="flex items-start gap-3">
      <span className="text-lg">‚úÖ</span>
      <div>
        <div className="font-bold text-sm">Double-Check Banking Details</div>
        <div className="text-xs text-muted-foreground mt-1">
          Verify account number, routing codes, and account holder name match request
        </div>
      </div>
    </div>
  </div>

  <div className="p-4 rounded-lg border border-border bg-muted/30">
    <div className="flex items-start gap-3">
      <span className="text-lg">‚úÖ</span>
      <div>
        <div className="font-bold text-sm">Notify User of Approval</div>
        <div className="text-xs text-muted-foreground mt-1">
          Send notification to user confirming transfer completion with expected arrival time
        </div>
      </div>
    </div>
  </div>

  <div className="p-4 rounded-lg border border-border bg-muted/30">
    <div className="flex items-start gap-3">
      <span className="text-lg">‚è±Ô∏è</span>
      <div>
        <div className="font-bold text-sm">Account for Processing Time</div>
        <div className="text-xs text-muted-foreground mt-1">
          Inform users that bank transfers may take 3-7 business days to appear in their account
        </div>
      </div>
    </div>
  </div>
</div>

## Related Operations

<Cards>
  <Card
    title="Send Confirmation Code"
    href="/docs/api/Withdraw/send-withdraw-confirmation-code"
    description="Request 2FA SMS code for approval (ADMIN)"
  />
  <Card
    title="Fiat Withdrawal Request"
    href="/docs/api/Withdraw/fiat-withdrawal-request"
    description="User operation to request bank withdrawal"
  />
  <Card
    title="Deny Bank Withdrawal"
    href="/docs/api/Withdraw/deny-bank-withdrawal-request"
    description="Deny bank withdrawal with reason (ADMIN)"
  />
  <Card
    title="Withdrawal Overview"
    href="/docs/api/Withdraw/withdraw-summary"
    description="Complete withdrawal API documentation"
  />
</Cards>

<div className="mt-8 p-6 rounded-xl border border-rose-500/30 bg-gradient-to-r from-rose-500/10 to-pink-500/10">
  <div className="flex items-center gap-3">
    <span className="text-2xl">üè¶</span>
    <div>
      <div className="font-bold">Manual Transfer Required</div>
      <div className="text-sm text-muted-foreground">Always confirm the bank transfer was completed successfully before approving the withdrawal request in the system</div>
    </div>
  </div>
</div>
