"use strict";(self.webpackChunkdocs_orbvpn_com=self.webpackChunkdocs_orbvpn_com||[]).push([[4312],{5969:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var t=i(4848),s=i(8453);const r={},o=void 0,c={id:"api/Registration/Sign in 2FA Check",title:"Sign in 2FA Check",description:"The confirm2FA mutation is used to confirm the second factor of authentication for a user who has successfully completed the initial sign-in stage. This step verifies the 2FA code provided by the user.",source:"@site/docs/api/Registration/Sign in 2FA Check.md",sourceDirName:"api/Registration",slug:"/api/Registration/Sign in 2FA Check",permalink:"/docs/api/Registration/Sign in 2FA Check",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/api/Registration/Sign in 2FA Check.md",tags:[],version:"current",frontMatter:{},sidebar:"apiSidebar",previous:{title:"Resend Verification Code",permalink:"/docs/api/Registration/Resend Verification Code"},next:{title:"Sign in",permalink:"/docs/api/Registration/Sign in"}},d={},a=[{value:"Mutation: <code>confirm2FA</code>",id:"mutation-confirm2fa",level:3},{value:"Schema:",id:"schema",level:4},{value:"Input: <code>TwoFAEntry</code>",id:"input-twofaentry",level:4},{value:"Type: <code>Credentials</code>",id:"type-credentials",level:4},{value:"Parameters",id:"parameters",level:4},{value:"Return",id:"return",level:4},{value:"Example Mutation",id:"example-mutation",level:3}];function l(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"confirm2FA"})," mutation is used to confirm the second factor of authentication for a user who has successfully completed the initial sign-in stage. This step verifies the 2FA code provided by the user."]}),"\n",(0,t.jsxs)(n.h3,{id:"mutation-confirm2fa",children:["Mutation: ",(0,t.jsx)(n.code,{children:"confirm2FA"})]}),"\n",(0,t.jsx)(n.h4,{id:"schema",children:"Schema:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"confirm2FA(\n  email: String!,\n  token: String!,\n  code: [TwoFAEntry]!\n): Credentials!\n"})}),"\n",(0,t.jsxs)(n.h4,{id:"input-twofaentry",children:["Input: ",(0,t.jsx)(n.code,{children:"TwoFAEntry"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"input TwoFAEntry {\n  key: String!\n  value: String!\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"key"})," (String): The 2FA method, such as ",(0,t.jsx)(n.code,{children:'"app"'})," or ",(0,t.jsx)(n.code,{children:'"email"'}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"value"})," (String): The 2FA code from the chosen method."]}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"type-credentials",children:["Type: ",(0,t.jsx)(n.code,{children:"Credentials"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"type Credentials {\n  status: String\n  token: String\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"status"})," (String): The status of the 2FA confirmation attempt."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"token"})," (String): The JWT token for authorization if the 2FA confirmation is successful."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"email"})," (String): The user's email address. This field is mandatory."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"token"})," (String): The token received from the previous sign-in stage. This field is mandatory."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"code"})," ([TwoFAEntry]): A list of 2FA entries containing the method and corresponding 2FA code. This field is mandatory."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"return",children:"Return"}),"\n",(0,t.jsx)(n.p,{children:"The mutation returns an object containing the status and token."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If successful:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"status"}),": ",(0,t.jsx)(n.code,{children:'"Success"'})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"token"}),": The JWT token for authorization."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["If failed:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"status"}),": ",(0,t.jsx)(n.code,{children:'"failed"'})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"token"}),": An error message indicating the reason for the failure:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'"Password expired"'})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'"2FA code mismatch"'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"example-mutation",children:"Example Mutation"}),"\n",(0,t.jsxs)(n.p,{children:["The following is an example of how to use the ",(0,t.jsx)(n.code,{children:"confirm2FA"})," mutation to confirm 2FA for a user:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  confirm2FA(\n    email: "demouser@nyyu.io",\n    token: "prevSignInToken",\n    code: [\n      { key: "app", value: "123456" }\n    ]\n  ) {\n    status,\n    token\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, the mutation attempts to confirm the 2FA for the user with the email address ",(0,t.jsx)(n.code,{children:"arthurclark655@gmail.com"}),", using the token ",(0,t.jsx)(n.code,{children:"prevSignInToken"})," from the previous sign-in stage, and the 2FA code ",(0,t.jsx)(n.code,{children:"123456"})," for the method ",(0,t.jsx)(n.code,{children:"app"}),". The return value will indicate whether the confirmation was successful and provide the JWT token for authorization, or if there was an error such as a code mismatch or expired password."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var t=i(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);